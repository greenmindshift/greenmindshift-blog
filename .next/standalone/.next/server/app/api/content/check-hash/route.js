"use strict";(()=>{var e={};e.id=363,e.ids=[363],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},570:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>x});var n={};r.r(n),r.d(n,{POST:()=>h});var s=r(9303),a=r(8716),o=r(670),i=r(7070),c=r(3524),u=r(9133);let d=new c.PrismaClient,l=u.z.object({contentHash:u.z.string().min(1)});async function h(e){try{let t=e.headers.get("authorization");if(!t||!t.startsWith("Bearer "))return i.NextResponse.json({error:"Unauthorized"},{status:401});if(t.split(" ")[1]!==process.env.BLOG_API_TOKEN)return i.NextResponse.json({error:"Invalid token"},{status:401});let r=await e.json(),{contentHash:n}=l.parse(r),s=await d.contentHash.findUnique({where:{contentHash:n}}),a=await d.article.findMany({where:{sourceHash:{not:null},aiGenerated:!0},select:{id:!0,title:!0,slug:!0,sourceHash:!0,createdAt:!0},take:5,orderBy:{createdAt:"desc"}});return i.NextResponse.json({exists:null!==s,existingContent:s?{id:s.id,title:s.title,source:s.source,createdAt:s.createdAt}:null,similarArticles:a,recommendation:s?"SKIP_DUPLICATE":a.length>3?"REVIEW_SIMILARITY":"PROCEED"})}catch(e){if(e instanceof u.z.ZodError)return i.NextResponse.json({error:"Invalid request data",details:e.errors},{status:400});return i.NextResponse.json({error:"Internal server error"},{status:500})}finally{await d.$disconnect()}}let p=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/content/check-hash/route",pathname:"/api/content/check-hash",filename:"route",bundlePath:"app/api/content/check-hash/route"},resolvedPagePath:"/home/greenmindshift/greenmindshift-blog/src/app/api/content/check-hash/route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:g}=p,f="/api/content/check-hash/route";function v(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:x})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,972,133],()=>r(570));module.exports=n})();